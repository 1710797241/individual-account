<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.models.dao.UserDao">
	<select id="selectAll" parameterType="java.util.Map" resultType="com.models.entity.User">
		select user_identity,
		user_name,
		user_sex,
		user_birth,
		user_phone,
		user_address,
		user_level,
		user_label
		from user
		where delete_status="no"
		<if test="user_name!=null and user_name!=''">
		and user_name like "%"#{user_name}"%"
		</if>
	</select>
	<select id="selectNameAndID" resultType="com.models.entity.User">
		select user_identity,
		user_name
		
		from user
	</select>
	<select id="checkForInsert" resultType="java.lang.Integer"  parameterType="com.models.entity.User">
		select count(1)
		from user
		where 
		
		user_identity=#{user_identity}
	</select>
	<insert id="insertMany" parameterType="com.models.entity.User">
		insert into user
		(user_identity,user_name,user_sex,user_age,user_birth,user_phone,user_address,
		user_level,user_label,delete_status
		)
		values
		(
			#{user_identity},
			#{user_name},
			#{user_sex},
			#{user_age},
			#{user_birth},
			#{user_phone},
			#{user_address},
			#{user_level},
			#{user_label},
			#{delete_status}
		
		)
		
	</insert>
	<select id="selectByCodeForModify" parameterType="java.lang.String" resultType="com.models.entity.User">
		select user_identity,
		user_name,
		user_sex,
		user_birth,
		user_phone,
		user_address,
		user_level,
		user_label
		from user
		where user_identity=#{user_identity}
	</select>
	<update id="modifyUser" parameterType="com.models.entity.User">
		update user
		set
		<trim suffixOverrides=",">
			
			<if test="user_name!=null and user_name !=''">
			user_name=#{user_name},
			</if>
			<if test="user_sex!=null and user_sex!=''">
			user_sex=#{user_sex},
			</if>
			<if test="user_age!=null and user_age!=''">
			user_age=#{user_age},
			</if>
			<if test="user_birth!=null and user_birth!=''">
			user_birth=#{user_birth},
			</if>
			<if test="user_phone!=null and user_phone!=''">
			user_phone=#{user_phone},
			</if>
			<if test="user_address!=null and user_address!=''">
			user_address=#{user_address},
			</if>
			<if test="user_level!=null and user_level!=''">
			user_level=#{user_level},
			</if>
			<if test="user_label!=null and user_label!=''">
			user_label=#{user_label},
			</if>
		</trim>
		where 
		<if test="user_identity!=null and user_identity!=''">
			user_identity=#{user_identity}
			</if>
	</update>
	
	<select id="checkBeforeDel" parameterType="java.lang.String" resultType="java.lang.Integer">
		select count(1)
		from account
		where user_identity = #{user_identity}
		
		
	</select>
	<update id="delUser" parameterType="java.lang.String">
		update user 
		set delete_status="yes"
		where user_identity =#{user_identity}
		
		
	</update>
</mapper>